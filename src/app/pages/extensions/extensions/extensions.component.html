<div class="container mt-4">
    <div class="mb-4">
        <h2 class="text-center border-bottom">Extensiones teléfonicas</h2>
    </div>
    <div class="mt-3 d-flex justify-content-between">
        <form>
            <div class="mb-3 row">
                <label for="table-filtering-search" class="col-xs-3 col-sm-auto col-form-label">Buscar:</label>
                <div class="col-xs-3 col-sm-auto">
                    <input
                    type="text"
                    class="form-control mb-3"
                    placeholder="Buscar..."
                    [(ngModel)]="search_text"
                    (input)="filterData()"
                    name="search_text"
                  />
                </div>
            </div>
        </form>
        <div>
            <button type="button" class="btn btn-primary" (click)="downloadExcel()">Excel</button>
        </div>
    </div>
    <table class="table table-bordered">
        <thead>
            <tr class="text-center">
                <th scope="col">#</th>
                <th scope="col">Nombre</th>
                <th scope="col">Extensión</th>
                <th scope="col">Empresa</th>
                <th scope="col">Departamento</th>
                <th scope="col">DID salida</th>
            </tr>
        </thead>
        <tbody>
            @for (extension of paginated_data; track extension.name; let i = $index) {
            <tr class="text-center" >
                <td>
                    <ngb-highlight [result]="extension.extension_id.toString()" [term]="search_text"/>
                </td>
                <td>
                    <ngb-highlight [result]="extension.name" [term]="search_text"/>
                </td>
                <td>
                    <ngb-highlight [result]="extension.extension" [term]="search_text"/>
                </td>
                <td>
                    <ngb-highlight [result]="extension.contact.organization" [term]="search_text"/>
                </td>
                <td>
                    <ngb-highlight [result]="extension.contact.location" [term]="search_text"/>
                </td>
                <td>
                    <ngb-highlight [result]="extension.did_number" [term]="search_text"/>
                </td>
            </tr>
        } @empty {
            <tr>
				<td colspan="6" style="text-align: center">No se encontraron resultados</td>
			</tr>
        }
        </tbody>
    </table>
    <div class="d-flex justify-content-between p-2">
        <ngb-pagination
        [(page)]="current_page"
        [collectionSize]="filtered_extensions.length"
        [pageSize]="page_size"
        (pageChange)="onPageChange($event)"
        [maxSize]="5"
      ></ngb-pagination>
</div>